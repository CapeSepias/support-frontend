Comment: Carries out the steps needed to create a Monthly Contributor
StartAt: CreatePaymentMethod
States:
  CreatePaymentMethod:
    Type: Task
    Resource: "${CreatePaymentMethodLambda.Arn}"
    Next: CreateSalesforceContact
    $state_machine_retries
  CreateSalesforceContact:
    Type: Task
    Resource: "${CreateSalesforceContactLambda.Arn}"
    Next: CreateZuoraSubscription
    $state_machine_retries
  CreateZuoraSubscription:
    Type: Task
    Resource: "${CreateZuoraSubscriptionLambda.Arn}"
    Next: SendThankYouEmail
    $state_machine_retries
  SendThankYouEmail:
    Type: Task
    Resource: "${SendThankYouEmailLambda.Arn}"
    End: True
    Retry:
    - ErrorEquals:
      - com.gu.support.workers.exceptions.RetryLimited
      IntervalSeconds: 1
      MaxAttempts: 3
      BackoffRate: 2
    - ErrorEquals:
      - com.gu.support.workers.exceptions.RetryUnlimited
      IntervalSeconds: 1
      BackoffRate: 2
  FailureHandler:
    Type: Task
    Resource: "${FailureHandlerLambda.Arn}"
    End: True